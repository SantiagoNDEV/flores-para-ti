<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para Ti</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: white;
            font-family: 'Courier New', Courier, monospace;
        }
        canvas {
            position: absolute;
        }
        .texto-central {
            position: absolute;
            z-index: 10;
            text-align: center;
            pointer-events: none; /* Para que no estorbe al click */
            animation: fadeIn 3s ease-in;
        }
        h1 {
            font-size: 2.5rem;
            text-shadow: 0 0 10px #ff69b4, 0 0 20px #ff69b4;
        }
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>

    <div class="texto-central">
        <h1 id="mensaje">Haz clic en la pantalla...</h1>
    </div>
    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let flowers = [];
        const maxFlowers = 40; // Límite máximo de flores en pantalla para no saturar

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // --- CLASE FLOR MODIFICADA (Ahora se desvanece) ---
        class Flower {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.size = 0;
                // Tamaño máximo variado
                this.maxSize = Math.random() * 30 + 15; 
                this.growthSpeed = Math.random() * 0.3 + 0.1;
                this.petals = Math.floor(Math.random() * 5) + 5;
                this.angle = Math.random() * Math.PI * 2;
                this.spin = Math.random() * 0.02 - 0.01;
                // Nuevas propiedades para el desvanecimiento
                this.opacity = 1;
                this.isDying = false;
            }

            grow() {
                // Fase de crecimiento
                if (this.size < this.maxSize && !this.isDying) {
                    this.size += this.growthSpeed;
                    this.angle += this.spin;
                } 
                // Cuando alcanza el tamaño máximo, empieza a "morir"
                else if (this.size >= this.maxSize) {
                    this.isDying = true;
                }

                // Fase de desvanecimiento suave
                if (this.isDying) {
                    this.opacity -= 0.003; // Velocidad de desaparición
                }
                
                // Solo dibujamos si aún es visible
                if (this.opacity > 0) {
                    this.draw();
                }
            }

            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.angle);
                // Aplicar transparencia global
                ctx.globalAlpha = this.opacity; 
                ctx.fillStyle = this.color;
                
                for (let i = 0; i < this.petals; i++) {
                    ctx.rotate((Math.PI * 2) / this.petals);
                    ctx.beginPath();
                    ctx.ellipse(0, this.size / 2, this.size / 4, this.size, 0, 0, Math.PI * 2);
                    ctx.fill();
                }

                ctx.fillStyle = "#ffeb3b"; // Centro amarillo
                ctx.beginPath();
                ctx.arc(0, 0, this.size / 4, 0, Math.PI * 2);
                ctx.fill();
                // Restaurar estado para no afectar otras flores
                ctx.restore(); 
            }
        }

        // --- NUEVA FUNCIÓN: Generador Automático ---
        function spawnAutoFlower() {
            // Solo crea si no hemos llegado al límite
            if (flowers.length < maxFlowers) {
                // Posición aleatoria en toda la pantalla
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                
                const colors = ['#ff69b4', '#ff1493', '#da70d6', '#ba55d3', '#ff0000', '#e91e63'];
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                
                flowers.push(new Flower(x, y, randomColor));
            }
        }

        // --- EVENTO CLIC (Solo para mostrar el mensaje) ---
        // Usamos { once: true } para que solo funcione la primera vez que se toca
        window.addEventListener('click', (e) => {
            const mensaje = document.getElementById('mensaje');
            // Tu mensaje personalizado
            mensaje.innerText = "Intente hacer esto lo mejor que pude, no soy el mejor programador ni desarrollador, pero lo hice con todo mi corazón para este 14 de Febrero.\n\nGracias por aparecer en mi vida y nunca irte aun viendo lo raro que soy, te quiero mucho mi princesa chihuaha molletito de frijol.\n\nNo creas que me olvide de tu cumpleaños, pero eso es para dentro de otros dias.\n\nBesos y abrazos.\nChantilly";

            // Estilos para que el texto largo se vea bien
            mensaje.style.fontSize = "1.1rem"; // Un poco más pequeño para que quepa
            mensaje.style.lineHeight = "1.6";  // Espacio entre líneas para leer mejor
            mensaje.style.maxWidth = "90%";    // Que no toque los bordes del celular
            mensaje.style.margin = "0 auto";
            // Opcional: si quieres que el primer clic también saque una flor
            spawnAutoFlower();
        }, { once: true });


        // --- ANIMACIÓN PRINCIPAL ---
        function animate() {
            // Fondo semi-transparente para el efecto de rastro suave
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)'; 
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // FILTRO IMPORTANTE: Elimina del array las flores que ya son invisibles (opacity <= 0)
            // Esto es lo que evita que se sature la memoria.
            flowers = flowers.filter(flower => flower.opacity > 0);

            // Hacer crecer las flores restantes
            flowers.forEach(flower => flower.grow());
            
            requestAnimationFrame(animate);
        }

        // Iniciar la animación
        animate();
        
        // --- ACTIVAR GENERADOR AUTOMÁTICO ---
        // Intenta crear una flor cada 600 milisegundos (ajusta este número si quieres más o menos velocidad)
        setInterval(spawnAutoFlower, 600); 

    </script>
</body>
</html>